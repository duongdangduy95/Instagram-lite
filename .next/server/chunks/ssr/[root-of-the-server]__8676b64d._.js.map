{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 3, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 21, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Admin/Documents/IT4409/Instagram-lite/lib/prisma.ts"],"sourcesContent":["// lib/prisma.ts\r\nimport { PrismaClient } from '@prisma/client';\r\n\r\nconst globalForPrisma = globalThis as unknown as {\r\n  prisma: PrismaClient | undefined;\r\n};\r\n\r\nexport const prisma =\r\n  globalForPrisma.prisma ??\r\n  new PrismaClient({\r\n    log: ['query'],\r\n  });\r\n\r\nif (process.env.NODE_ENV !== 'production') globalForPrisma.prisma = prisma;\r\n"],"names":[],"mappings":"AAAA,gBAAgB;;;;;AAChB;;AAEA,MAAM,kBAAkB;AAIjB,MAAM,SACX,gBAAgB,MAAM,IACtB,IAAI,6IAAY,CAAC;IACf,KAAK;QAAC;KAAQ;AAChB;AAEF,wCAA2C,gBAAgB,MAAM,GAAG","debugId":null}},
    {"offset": {"line": 39, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Admin/Documents/IT4409/Instagram-lite/lib/formatTimeAgo.ts"],"sourcesContent":["import { formatDistanceToNow } from 'date-fns'\r\nimport { vi } from 'date-fns/locale'\r\n\r\nexport function formatTimeAgo(date: Date | string) {\r\n  return formatDistanceToNow(new Date(date), { addSuffix: true, locale: vi })\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,SAAS,cAAc,IAAmB;IAC/C,OAAO,IAAA,wMAAmB,EAAC,IAAI,KAAK,OAAO;QAAE,WAAW;QAAM,QAAQ,gLAAE;IAAC;AAC3E","debugId":null}},
    {"offset": {"line": 57, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Admin/Documents/IT4409/Instagram-lite/app/components/Navigation.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/IT4409/Instagram-lite/app/components/Navigation.tsx <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/IT4409/Instagram-lite/app/components/Navigation.tsx <module evaluation>\",\n    \"default\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;AACvE;;uCACe,IAAA,uSAAuB,EAClC;IAAa,MAAM,IAAI,MAAM;AAAuT,GACpV,qFACA","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 71, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Admin/Documents/IT4409/Instagram-lite/app/components/Navigation.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/IT4409/Instagram-lite/app/components/Navigation.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/IT4409/Instagram-lite/app/components/Navigation.tsx\",\n    \"default\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;AACvE;;uCACe,IAAA,uSAAuB,EAClC;IAAa,MAAM,IAAI,MAAM;AAAmS,GAChU,iEACA","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 85, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 93, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Admin/Documents/IT4409/Instagram-lite/app/components/BlogActions.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/IT4409/Instagram-lite/app/components/BlogActions.tsx <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/IT4409/Instagram-lite/app/components/BlogActions.tsx <module evaluation>\",\n    \"default\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;AACvE;;uCACe,IAAA,uSAAuB,EAClC;IAAa,MAAM,IAAI,MAAM;AAAwT,GACrV,sFACA","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 107, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Admin/Documents/IT4409/Instagram-lite/app/components/BlogActions.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/IT4409/Instagram-lite/app/components/BlogActions.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/IT4409/Instagram-lite/app/components/BlogActions.tsx\",\n    \"default\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;AACvE;;uCACe,IAAA,uSAAuB,EAClC;IAAa,MAAM,IAAI,MAAM;AAAoS,GACjU,kEACA","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 121, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 129, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Admin/Documents/IT4409/Instagram-lite/app/components/FollowButton.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/IT4409/Instagram-lite/app/components/FollowButton.tsx <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/IT4409/Instagram-lite/app/components/FollowButton.tsx <module evaluation>\",\n    \"default\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;AACvE;;uCACe,IAAA,uSAAuB,EAClC;IAAa,MAAM,IAAI,MAAM;AAAyT,GACtV,uFACA","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 143, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Admin/Documents/IT4409/Instagram-lite/app/components/FollowButton.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/IT4409/Instagram-lite/app/components/FollowButton.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/IT4409/Instagram-lite/app/components/FollowButton.tsx\",\n    \"default\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;AACvE;;uCACe,IAAA,uSAAuB,EAClC;IAAa,MAAM,IAAI,MAAM;AAAqS,GAClU,mEACA","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 157, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 165, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Admin/Documents/IT4409/Instagram-lite/app/components/BlogImages.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/IT4409/Instagram-lite/app/components/BlogImages.tsx <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/IT4409/Instagram-lite/app/components/BlogImages.tsx <module evaluation>\",\n    \"default\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;AACvE;;uCACe,IAAA,uSAAuB,EAClC;IAAa,MAAM,IAAI,MAAM;AAAuT,GACpV,qFACA","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 179, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Admin/Documents/IT4409/Instagram-lite/app/components/BlogImages.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/IT4409/Instagram-lite/app/components/BlogImages.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/IT4409/Instagram-lite/app/components/BlogImages.tsx\",\n    \"default\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;AACvE;;uCACe,IAAA,uSAAuB,EAClC;IAAa,MAAM,IAAI,MAAM;AAAmS,GAChU,iEACA","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 193, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 255, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Admin/Documents/IT4409/Instagram-lite/lib/auth.ts"],"sourcesContent":["// lib/auth.ts\r\nimport { AuthOptions } from \"next-auth\"\r\nimport { PrismaAdapter } from '@auth/prisma-adapter'\r\nimport { prisma } from './prisma'\r\nexport const authOptions: AuthOptions = {\r\n  adapter: PrismaAdapter(prisma),\r\n  providers: [\r\n   \r\n  ],\r\n  callbacks: {\r\n    // Thêm user.id vào JWT token\r\n    async jwt({ token, user }) {\r\n      if (user) {\r\n        token.id = user.id\r\n      }\r\n      return token\r\n    },\r\n    // Thêm user.id vào session\r\n    async session({ session, token }) {\r\n      if (token?.id) {\r\n        session.user.id = token.id as string\r\n      }\r\n      return session\r\n    },\r\n  },\r\n  session: {\r\n    strategy: 'jwt',\r\n  },\r\n  secret: process.env.NEXTAUTH_SECRET,\r\n}\r\n"],"names":[],"mappings":"AAAA,cAAc;;;;;AAEd;AACA;;;AACO,MAAM,cAA2B;IACtC,SAAS,IAAA,oMAAa,EAAC,sJAAM;IAC7B,WAAW,EAEV;IACD,WAAW;QACT,6BAA6B;QAC7B,MAAM,KAAI,EAAE,KAAK,EAAE,IAAI,EAAE;YACvB,IAAI,MAAM;gBACR,MAAM,EAAE,GAAG,KAAK,EAAE;YACpB;YACA,OAAO;QACT;QACA,2BAA2B;QAC3B,MAAM,SAAQ,EAAE,OAAO,EAAE,KAAK,EAAE;YAC9B,IAAI,OAAO,IAAI;gBACb,QAAQ,IAAI,CAAC,EAAE,GAAG,MAAM,EAAE;YAC5B;YACA,OAAO;QACT;IACF;IACA,SAAS;QACP,UAAU;IACZ;IACA,QAAQ,QAAQ,GAAG,CAAC,eAAe;AACrC","debugId":null}},
    {"offset": {"line": 292, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Admin/Documents/IT4409/Instagram-lite/app/home/page.tsx"],"sourcesContent":["import Link from 'next/link'\r\nimport { prisma } from '@/lib/prisma'\r\nimport { formatTimeAgo } from '@/lib/formatTimeAgo'\r\nimport Navigation from '../components/Navigation'\r\nimport BlogActions from '../components/BlogActions'\r\nimport FollowButton from '../components/FollowButton'\r\nimport BlogImages from '../components/BlogImages'\r\nimport { getServerSession } from 'next-auth'\r\nimport { authOptions } from '@/lib/auth'\r\n\r\ntype BlogWithRelations = {\r\n  id: string\r\n  caption?: string\r\n  imageUrls: string[]\r\n  createdAt: Date\r\n  author: {\r\n    id: string\r\n    fullname: string\r\n    username: string\r\n    followers?: { followerId: string }[]\r\n  }\r\n  likes?: { userId: string }[]\r\n  _count: {\r\n    likes: number\r\n    comments: number\r\n  }\r\n  sharedFrom?: BlogWithRelations\r\n}\r\n\r\n// Lấy người dùng hiện tại từ session\r\nasync function getCurrentUser() {\r\n  const session = await getServerSession(authOptions)\r\n  if (!session?.user?.id) return null\r\n  return prisma.user.findUnique({ where: { id: session.user.id } })\r\n}\r\n\r\nexport default async function HomePage() {\r\n  const currentUser = await getCurrentUser()\r\n\r\n  const blogs: BlogWithRelations[] = await prisma.blog.findMany({\r\n    select: {\r\n      id: true,\r\n      caption: true,\r\n      imageUrls: true,\r\n      createdAt: true,\r\n      author: {\r\n        select: {\r\n          id: true,\r\n          fullname: true,\r\n          username: true,\r\n          followers: currentUser\r\n            ? { where: { followerId: currentUser.id } }\r\n            : undefined,\r\n        },\r\n      },\r\n      sharedFrom: {\r\n        select: {\r\n          id: true,\r\n          caption: true,\r\n          imageUrls: true,\r\n          createdAt: true,\r\n          author: { select: { id: true, fullname: true, username: true } },\r\n          _count: { select: { likes: true, comments: true } },\r\n        },\r\n      },\r\n      likes: currentUser\r\n        ? { select: { userId: true }, where: { userId: currentUser.id } }\r\n        : undefined,\r\n      _count: { select: { likes: true, comments: true } },\r\n    },\r\n    orderBy: { createdAt: 'desc' },\r\n  })\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-100\">\r\n      <Navigation />\r\n\r\n      <main className=\"max-w-2xl mx-auto p-4 space-y-4\">\r\n        {blogs.map((blog) => {\r\n          const isShared = !!blog.sharedFrom\r\n          const displayBlog = blog.sharedFrom ?? blog\r\n          const isCurrentUser = blog.author.id === currentUser?.id\r\n          const isFollowing = (blog.author.followers?.length ?? 0) > 0\r\n          const isLiked = (blog.likes?.length ?? 0) > 0\r\n\r\n          return (\r\n            <div key={blog.id} className=\"bg-white rounded-lg border shadow\">\r\n              {/* NGƯỜI SHARE */}\r\n              {isShared && (\r\n                <div className=\"px-4 pt-4 text-sm text-gray-600\">\r\n                  <span className=\"font-semibold\">{blog.author.fullname}</span> đã chia sẻ\r\n                </div>\r\n              )}\r\n\r\n              {/* HEADER */}\r\n              <div className=\"p-4 flex justify-between items-center\">\r\n                <Link href={`/profile/${displayBlog.author.id}`}>\r\n                  <div className=\"flex items-center space-x-3\">\r\n                    <div className=\"w-10 h-10 bg-gray-300 rounded-full flex items-center justify-center\">\r\n                      <span className=\"font-bold text-gray-700\">\r\n                        {displayBlog.author.fullname.charAt(0)}\r\n                      </span>\r\n                    </div>\r\n                    <div>\r\n                      <p className=\"font-semibold\">{displayBlog.author.fullname}</p>\r\n                      <p className=\"text-xs text-gray-500\">\r\n                        {formatTimeAgo(displayBlog.createdAt)}\r\n                      </p>\r\n                    </div>\r\n                  </div>\r\n                </Link>\r\n\r\n                {!isCurrentUser && currentUser && (\r\n                  <FollowButton\r\n                    targetUserId={displayBlog.author.id}\r\n                    initialIsFollowing={isFollowing}\r\n                  />\r\n                )}\r\n              </div>\r\n\r\n              {/* CAPTION */}\r\n              {displayBlog.caption && (\r\n                <div className=\"px-4 pb-2 text-gray-800 border-b\">{displayBlog.caption}</div>\r\n              )}\r\n\r\n              {/* KHUNG ẢNH MULTI */}\r\n              <div className=\"mx-4 mb-4 border rounded-lg overflow-hidden bg-gray-50\">\r\n                <BlogImages imageUrls={displayBlog.imageUrls} blogId={displayBlog.id} />\r\n              </div>\r\n\r\n\r\n              <BlogActions\r\n                blogId={blog.id}\r\n                displayBlogId={displayBlog.id}\r\n                initialLikeCount={blog._count.likes}\r\n                initialCommentCount={blog._count.comments}\r\n                initialLiked={isLiked}\r\n                currentUser={\r\n                  currentUser\r\n                    ? { id: currentUser.id, fullname: currentUser.fullname, username: currentUser.username }\r\n                    : null\r\n                }\r\n              />\r\n            </div>\r\n          )\r\n        })}\r\n      </main>\r\n    </div>\r\n  )\r\n}"],"names":[],"mappings":"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","debugId":null}}]
}