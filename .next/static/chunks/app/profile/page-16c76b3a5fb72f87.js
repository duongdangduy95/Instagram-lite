(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[636],{63:(e,s,t)=>{"use strict";var l=t(7260);t.o(l,"useRouter")&&t.d(s,{useRouter:function(){return l.useRouter}})},362:(e,s,t)=>{Promise.resolve().then(t.bind(t,928))},928:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>d});var l=t(5155),a=t(2115),n=t(2619),r=t.n(n),i=t(5239),c=t(1503),o=t(7840);function d(){var e;let[s,t]=(0,a.useState)(null),[n,d]=(0,a.useState)([]),[x,h]=(0,a.useState)([]),[u,m]=(0,a.useState)("posts"),[g,p]=(0,a.useState)(null),[b,f]=(0,a.useState)(""),[j,y]=(0,a.useState)(null),[v,N]=(0,a.useState)(null),[w,k]=(0,a.useState)(!1),[D,C]=(0,a.useState)(null),[E,S]=(0,a.useState)(!1),[T,_]=(0,a.useState)({fullname:"",email:"",phone:""}),[A,L]=(0,a.useState)({}),H=async()=>{let e=await fetch("/api/me",{credentials:"include"}),s=await e.json();console.log(s),s&&!s.error&&(t(s),d(s.blogs),h(s.likes.map(e=>e.blog)))};(0,a.useEffect)(()=>{H()},[]),(0,a.useEffect)(()=>{let e=()=>{H()};return window.addEventListener("focus",e),()=>window.removeEventListener("focus",e)},[]),(0,a.useEffect)(()=>{let e=setInterval(()=>{H()},1e4);return()=>clearInterval(e)},[]),(0,a.useEffect)(()=>{let e=e=>{D&&C(null)};return document.addEventListener("click",e),()=>document.removeEventListener("click",e)},[D]);let O=async e=>{k(!0);try{let s=new FormData;s.append("caption",b),j&&s.append("image",j);let t=await fetch("/api/blog/".concat(e),{method:"PATCH",body:s,credentials:"include"});if(t.ok){let s=await t.json();d(t=>t.map(t=>t.id===e?{...t,caption:s.blog.caption,imageUrl:s.blog.imageUrl||t.imageUrl,_count:t._count}:t)),p(null),f(""),y(null),alert("Cập nhật b\xe0i viết th\xe0nh c\xf4ng!")}else alert("C\xf3 lỗi xảy ra khi cập nhật b\xe0i viết")}catch(e){console.error("Error updating post:",e),alert("C\xf3 lỗi xảy ra khi cập nhật b\xe0i viết")}finally{k(!1)}},U=()=>{p(null),f(""),y(null)},I=async e=>{k(!0);try{(await fetch("/api/blog/".concat(e),{method:"DELETE",credentials:"include"})).ok?(d(s=>s.filter(s=>s.id!==e)),N(null),alert("X\xf3a b\xe0i viết th\xe0nh c\xf4ng!")):alert("C\xf3 lỗi xảy ra khi x\xf3a b\xe0i viết")}catch(e){console.error("Error deleting post:",e),alert("C\xf3 lỗi xảy ra khi x\xf3a b\xe0i viết")}finally{k(!1)}},P=async()=>{if((()=>{let e={};return T.fullname.trim()?T.fullname.trim().length<2?e.fullname="Họ v\xe0 t\xean phải c\xf3 \xedt nhất 2 k\xfd tự":T.fullname.trim().length>50&&(e.fullname="Họ v\xe0 t\xean kh\xf4ng được qu\xe1 50 k\xfd tự"):e.fullname="Họ v\xe0 t\xean kh\xf4ng được để trống",T.email.trim()?/\S+@\S+\.\S+/.test(T.email)||(e.email="Email kh\xf4ng hợp lệ"):e.email="Email kh\xf4ng được để trống",T.phone.trim()&&(/^[0-9]{10,11}$/.test(T.phone.replace(/\s/g,""))||(e.phone="Số điện thoại phải c\xf3 10-11 chữ số")),L(e),0===Object.keys(e).length})()){k(!0);try{let e=await fetch("/api/me",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(T),credentials:"include"});if(e.ok){let s=await e.json();t(s),S(!1),L({}),alert("Cập nhật hồ sơ th\xe0nh c\xf4ng!")}else{let s=await e.json();409===e.status?L({email:"Email đ\xe3 được sử dụng"}):alert(s.error||"Kh\xf4ng thể cập nhật hồ sơ")}}catch(e){alert("C\xf3 lỗi xảy ra")}finally{k(!1)}}};return s?(0,l.jsxs)("div",{className:"min-h-screen bg-gray-100",children:[(0,l.jsx)(o.A,{}),(0,l.jsxs)("div",{className:"bg-white",children:[(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)("div",{className:"h-80 bg-gradient-to-r from-blue-400 via-purple-500 to-pink-500 relative overflow-hidden",children:(0,l.jsx)("div",{className:"absolute inset-0 bg-black bg-opacity-20"})}),(0,l.jsx)("div",{className:"absolute -bottom-6 left-6",children:(0,l.jsxs)("div",{className:"flex items-end space-x-4",children:[(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)("div",{className:"w-40 h-40 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full border-4 border-white shadow-lg flex items-center justify-center",children:(0,l.jsx)("span",{className:"text-4xl font-bold text-white",children:null==(e=s.fullname)?void 0:e.charAt(0).toUpperCase()})}),(0,l.jsx)("div",{className:"absolute bottom-2 right-2 w-8 h-8 bg-green-500 rounded-full border-3 border-white"})]}),(0,l.jsxs)("div",{className:"pb-4",children:[(0,l.jsx)("h1",{className:"text-3xl font-bold text-white drop-shadow-lg",children:s.fullname}),(0,l.jsxs)("p",{className:"text-lg text-gray-200 drop-shadow",children:["@",s.username]})]})]})})]}),(0,l.jsx)("div",{className:"pt-8 pb-4 px-6",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)("div",{className:"flex-1",children:(0,l.jsx)("div",{className:"mt-2 text-gray-600",children:(0,l.jsxs)("div",{className:"flex items-center space-x-6 text-sm",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,l.jsx)("span",{children:"\uD83D\uDCE7"}),(0,l.jsx)("span",{children:s.email})]}),(0,l.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,l.jsx)("span",{children:"\uD83D\uDCF1"}),(0,l.jsx)("span",{children:s.phone})]})]})})}),(0,l.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,l.jsx)(r(),{href:"/home",className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors font-medium",children:"\uD83C\uDFE0 Trang chủ"}),(0,l.jsx)(r(),{href:"/blog/create",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium",children:"+ Th\xeam b\xe0i viết"}),(0,l.jsx)("button",{onClick:()=>{_({fullname:s.fullname,email:s.email,phone:s.phone||""}),L({}),S(!0)},className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors",children:"✏️ Chỉnh sửa trang c\xe1 nh\xe2n"})]})]})}),(0,l.jsx)("div",{className:"px-6 border-t",children:(0,l.jsxs)("div",{className:"flex space-x-8",children:[(0,l.jsxs)("button",{onClick:()=>m("posts"),className:"py-4 font-medium border-b-2 transition-colors ".concat("posts"===u?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900"),children:["B\xe0i viết (",n.length,")"]}),(0,l.jsxs)("button",{onClick:()=>m("liked"),className:"py-4 font-medium border-b-2 transition-colors ".concat("liked"===u?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900"),children:["Đ\xe3 th\xedch (",x.length,")"]})]})})]}),(0,l.jsxs)("div",{className:"max-w-4xl mx-auto px-4 py-6 grid grid-cols-12 gap-6",children:[(0,l.jsxs)("div",{className:"col-span-12 lg:col-span-4 space-y-4",children:[(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-4",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Giới thiệu"}),(0,l.jsxs)("div",{className:"space-y-3 text-sm",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-2 text-gray-600",children:[(0,l.jsx)("span",{children:"\uD83D\uDC64"}),(0,l.jsxs)("span",{children:["T\xean: ",s.fullname]})]}),(0,l.jsxs)("div",{className:"flex items-center space-x-2 text-gray-600",children:[(0,l.jsx)("span",{children:"\uD83D\uDCE7"}),(0,l.jsx)("span",{children:s.email})]}),(0,l.jsxs)("div",{className:"flex items-center space-x-2 text-gray-600",children:[(0,l.jsx)("span",{children:"\uD83D\uDCF1"}),(0,l.jsx)("span",{children:s.phone})]})]})]}),(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-4",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Thống k\xea"}),(0,l.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,l.jsxs)("div",{className:"text-center p-3 bg-blue-50 rounded-lg",children:[(0,l.jsx)("div",{className:"text-xl font-bold text-blue-600",children:n.length}),(0,l.jsx)("div",{className:"text-xs text-gray-600",children:"B\xe0i viết"})]}),(0,l.jsxs)("div",{className:"text-center p-3 bg-pink-50 rounded-lg",children:[(0,l.jsx)("div",{className:"text-xl font-bold text-pink-600",children:n.reduce((e,s)=>{var t;return e+((null==(t=s._count)?void 0:t.likes)||0)},0)}),(0,l.jsx)("div",{className:"text-xs text-gray-600",children:"Tổng like"})]}),(0,l.jsxs)("div",{className:"text-center p-3 bg-purple-50 rounded-lg",children:[(0,l.jsx)("div",{className:"text-xl font-bold text-purple-600",children:x.length}),(0,l.jsx)("div",{className:"text-xs text-gray-600",children:"Đ\xe3 th\xedch"})]})]})]})]}),(0,l.jsxs)("div",{className:"col-span-12 lg:col-span-8",children:["posts"===u&&(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-4 mb-4",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,l.jsx)("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-purple-500 rounded-full flex items-center justify-center",children:(0,l.jsx)("span",{className:"text-white font-semibold text-sm",children:s.fullname.charAt(0).toUpperCase()})}),(0,l.jsxs)(r(),{href:"/blog/create",className:"flex-1 px-4 py-2 bg-gray-100 rounded-full text-gray-500 hover:bg-gray-200 transition-colors cursor-pointer",children:[s.fullname," ơi, bạn đang nghĩ g\xec thế?"]})]}),(0,l.jsx)("div",{className:"flex items-center justify-around mt-3 pt-3 border-t",children:(0,l.jsxs)(r(),{href:"/blog/create",className:"flex items-center space-x-2 px-4 py-2 hover:bg-gray-100 rounded-lg transition-colors flex-1 justify-center",children:[(0,l.jsx)("span",{className:"text-green-500",children:"\uD83D\uDCF8"}),(0,l.jsx)("span",{className:"text-gray-600 font-medium",children:"Ảnh/Video"})]})})]}),(0,l.jsx)("div",{className:"space-y-4",children:("posts"===u?n:x).map(e=>{var t,a,n;return(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow-sm",children:[(0,l.jsxs)("div",{className:"p-4 flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,l.jsx)("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-purple-500 rounded-full flex items-center justify-center",children:(0,l.jsx)("span",{className:"text-white font-semibold text-sm",children:s.fullname.charAt(0).toUpperCase()})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"font-semibold text-gray-900",children:s.fullname}),(0,l.jsx)("p",{className:"text-xs text-gray-500",children:new Date(e.createdAt).toLocaleDateString("vi-VN",{day:"numeric",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"})})]})]}),"posts"===u&&(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)("button",{className:"text-gray-400 hover:text-gray-600 p-2 rounded-full hover:bg-gray-100 transition-colors",onClick:()=>C(D===e.id?null:e.id),children:(0,l.jsx)("span",{className:"text-xl",children:"•••"})}),D===e.id&&(0,l.jsxs)("div",{className:"absolute right-0 top-full mt-1 w-48 bg-white rounded-lg shadow-lg border border-gray-200 py-2 z-10",children:[(0,l.jsxs)("button",{onClick:()=>{p(e.id),f(e.caption),y(null),C(null)},className:"w-full px-4 py-2 text-left text-gray-700 hover:bg-gray-100 flex items-center space-x-2",children:[(0,l.jsx)("span",{children:"✏️"}),(0,l.jsx)("span",{children:"Chỉnh sửa b\xe0i viết"})]}),(0,l.jsxs)("button",{onClick:()=>{N(e.id),C(null)},className:"w-full px-4 py-2 text-left text-red-600 hover:bg-red-50 flex items-center space-x-2",children:[(0,l.jsx)("span",{children:"\uD83D\uDDD1️"}),(0,l.jsx)("span",{children:"X\xf3a b\xe0i viết"})]})]})]})]}),g===e.id?(0,l.jsxs)("div",{className:"px-4 pb-3",children:[(0,l.jsx)("textarea",{value:b,onChange:e=>f(e.target.value),className:"w-full p-3 border border-gray-300 rounded-lg resize-none focus:outline-none focus:ring-2 focus:ring-blue-500",rows:3,placeholder:"Nhập nội dung b\xe0i viết..."}),(0,l.jsxs)("div",{className:"mt-3",children:[(0,l.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{var s;return y((null==(s=e.target.files)?void 0:s[0])||null)},className:"mb-3"}),(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)("button",{onClick:()=>O(e.id),disabled:w,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:w?"Đang lưu...":"Lưu thay đổi"}),(0,l.jsx)("button",{onClick:U,className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition-colors",children:"Hủy"})]})]})]}):(0,l.jsx)("div",{className:"px-4 pb-3",children:(0,l.jsx)("p",{className:"text-gray-900",children:e.caption})}),(0,l.jsx)(r(),{href:"/blog/".concat(e.id),children:(0,l.jsx)("div",{className:"cursor-pointer",children:(0,l.jsx)(i.default,{src:e.imageUrl,alt:e.caption,width:600,height:400,className:"w-full h-auto object-cover"})})}),(0,l.jsxs)("div",{className:"p-4",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between text-gray-500 text-sm mb-3",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,l.jsx)("span",{className:"text-blue-500",children:"\uD83D\uDC4D"}),(0,l.jsxs)("span",{className:"font-semibold text-gray-900",children:[(null==(t=e._count)?void 0:t.likes)||0," lượt th\xedch"]})]}),(0,l.jsx)("div",{className:"flex items-center space-x-4",children:(0,l.jsxs)("span",{children:[(null==(a=e._count)?void 0:a.comments)||0," b\xecnh luận"]})})]}),(0,l.jsxs)("div",{className:"flex items-center justify-around border-t pt-2",children:[(0,l.jsx)(c.default,{blogId:e.id,userId:null==s?void 0:s.id,initialLikes:(null==(n=e._count)?void 0:n.likes)||0,onLikeChange:s=>{d(t=>t.map(t=>t.id===e.id?{...t,_count:{...t._count,likes:s}}:t)),h(t=>t.map(t=>t.id===e.id?{...t,_count:{...t._count,likes:s}}:t))}}),(0,l.jsxs)(r(),{href:"/blog/".concat(e.id),className:"flex items-center space-x-2 px-4 py-2 hover:bg-gray-100 rounded-lg transition-colors flex-1 justify-center",children:[(0,l.jsx)("span",{className:"text-gray-600",children:"\uD83D\uDCAC"}),(0,l.jsx)("span",{className:"text-gray-600 font-medium",children:"B\xecnh luận"})]}),(0,l.jsxs)("button",{className:"flex items-center space-x-2 px-4 py-2 hover:bg-gray-100 rounded-lg transition-colors flex-1 justify-center",children:[(0,l.jsx)("span",{className:"text-gray-600",children:"\uD83D\uDCE4"}),(0,l.jsx)("span",{className:"text-gray-600 font-medium",children:"Chia sẻ"})]})]})]})]},e.id)})}),0===("posts"===u?n:x).length&&(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-8 text-center",children:[(0,l.jsx)("div",{className:"w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,l.jsx)("span",{className:"text-2xl text-gray-400",children:"posts"===u?"\uD83D\uDCDD":"❤️"})}),(0,l.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"posts"===u?"Chưa c\xf3 b\xe0i viết n\xe0o":"Chưa c\xf3 b\xe0i viết được th\xedch"}),(0,l.jsx)("p",{className:"text-gray-500 mb-4",children:"posts"===u?"Chia sẻ khoảnh khắc đầu ti\xean của bạn!":"H\xe3y bắt đầu kh\xe1m ph\xe1 v\xe0 th\xedch những b\xe0i viết bạn y\xeau th\xedch!"}),"posts"===u&&(0,l.jsx)(r(),{href:"/blog/create",className:"inline-flex items-center px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Tạo b\xe0i viết đầu ti\xean"})]})]})]}),v&&(0,l.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,l.jsxs)("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"X\xe1c nhận x\xf3a b\xe0i viết"}),(0,l.jsx)("p",{className:"text-gray-600 mb-6",children:"Bạn c\xf3 chắc chắn muốn x\xf3a b\xe0i viết n\xe0y? H\xe0nh động n\xe0y kh\xf4ng thể ho\xe0n t\xe1c."}),(0,l.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,l.jsx)("button",{onClick:()=>I(v),disabled:w,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors disabled:opacity-50",children:w?"Đang x\xf3a...":"X\xf3a b\xe0i viết"}),(0,l.jsx)("button",{onClick:()=>N(null),className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition-colors",children:"Hủy"})]})]})}),E&&(0,l.jsx)("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 animate-fadeIn",children:(0,l.jsxs)("div",{className:"bg-white rounded-2xl p-8 max-w-md w-full mx-4 shadow-2xl animate-slideUp",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,l.jsx)("h3",{className:"text-2xl font-bold text-gray-900",children:"Chỉnh sửa hồ sơ"}),(0,l.jsx)("button",{onClick:()=>S(!1),className:"text-gray-500 hover:text-gray-700 text-2xl",children:"✕"})]}),(0,l.jsxs)("div",{className:"space-y-5",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"\uD83D\uDC64 Họ v\xe0 t\xean"}),(0,l.jsx)("input",{type:"text",value:T.fullname,onChange:e=>{_({...T,fullname:e.target.value}),A.fullname&&L({...A,fullname:""})},className:"w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:border-transparent transition-all ".concat(A.fullname?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-500"),placeholder:"Nhập họ v\xe0 t\xean"}),A.fullname&&(0,l.jsxs)("p",{className:"text-red-500 text-sm mt-1",children:["⚠️ ",A.fullname]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"\uD83D\uDCE7 Email"}),(0,l.jsx)("input",{type:"email",value:T.email,onChange:e=>{_({...T,email:e.target.value}),A.email&&L({...A,email:""})},className:"w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:border-transparent transition-all ".concat(A.email?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-500"),placeholder:"Nhập email"}),A.email&&(0,l.jsxs)("p",{className:"text-red-500 text-sm mt-1",children:["⚠️ ",A.email]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"\uD83D\uDCF1 Số điện thoại"}),(0,l.jsx)("input",{type:"tel",value:T.phone,onChange:e=>{_({...T,phone:e.target.value}),A.phone&&L({...A,phone:""})},className:"w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:border-transparent transition-all ".concat(A.phone?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-500"),placeholder:"Nhập số điện thoại"}),A.phone&&(0,l.jsxs)("p",{className:"text-red-500 text-sm mt-1",children:["⚠️ ",A.phone]})]})]}),(0,l.jsxs)("div",{className:"flex items-center space-x-3 mt-8",children:[(0,l.jsx)("button",{onClick:P,disabled:w||Object.keys(A).length>0,className:"flex-1 px-4 py-3 rounded-lg transition-all font-semibold transform active:scale-95 ".concat(Object.keys(A).length>0?"bg-gray-400 text-gray-600 cursor-not-allowed":"bg-gradient-to-r from-blue-500 to-blue-600 text-white hover:from-blue-600 hover:to-blue-700 hover:scale-105"," disabled:opacity-50 disabled:cursor-not-allowed"),children:w?"⏳ Đang lưu...":"✓ Lưu thay đổi"}),(0,l.jsx)("button",{onClick:()=>S(!1),className:"flex-1 px-4 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-all font-semibold transform hover:scale-105 active:scale-95",children:"Hủy"})]})]})})]}):(0,l.jsx)("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center",children:(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,l.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),(0,l.jsx)("p",{className:"mt-3 text-gray-600 text-center text-sm",children:"Đang tải..."})]})})}},1503:(e,s,t)=>{"use strict";t.d(s,{default:()=>r});var l=t(5155),a=t(2115),n=t(63);function r(e){let{blogId:s,initialLiked:t=!1,initialCount:r=0,userId:i,onLikeChange:c}=e,o=(0,n.useRouter)(),[d,x]=(0,a.useState)(t),[h,u]=(0,a.useState)(r),[m,g]=(0,a.useState)(!1),[p,b]=(0,a.useState)(null);(0,a.useEffect)(()=>{(async()=>{try{let e=await fetch("/api/me",{method:"GET",credentials:"include"});if(!e.ok){console.log("Kh\xf4ng c\xf3 session, chuyển hướng đến /login"),b(!1);return}let s=await e.json();console.log("User session found:",s),b(!0)}catch(e){console.error("Lỗi kiểm tra session:",e),b(!1)}})()},[]);let f=async()=>{if(null===p)return void console.log("Đang kiểm tra session...");if(!p){console.log("Kh\xf4ng c\xf3 session, chuyển hướng đến /login"),o.push("/login");return}g(!0);try{console.log("Sending like request for blog:",s);let e=await fetch("/api/blog/".concat(s,"/like"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include"});if(console.log("Response status:",e.status),!e.ok){let s=await e.text();throw console.error("Server error:",s),Error("HTTP ".concat(e.status,": ").concat(s))}let t=await e.json();console.log("Like response:",t),x(t.liked);let l=t.liked?h+1:h-1;u(l),c&&c(l)}catch(e){console.error("Like error:",e),e instanceof Error&&e.message.includes("401")&&(console.log("Session invalid, redirecting to login"),o.push("/login"))}finally{g(!1)}};return(0,l.jsxs)("button",{onClick:f,disabled:m||null===p,className:"flex items-center space-x-2 px-4 py-2 rounded-lg transition-colors flex-1 justify-center ".concat(m||null===p?"opacity-50 cursor-not-allowed":"hover:bg-gray-100"),children:[(0,l.jsx)("span",{className:d?"text-blue-500":"text-gray-600",children:"\uD83D\uDC4D"}),(0,l.jsx)("span",{className:"font-medium ".concat(d?"text-blue-600":"text-gray-600"),children:m?"Đang xử l\xfd...":d?"Đ\xe3 th\xedch":"Th\xedch"}),h>0&&(0,l.jsxs)("span",{className:"text-sm text-gray-500",children:["(",h,")"]})]})}},4652:(e,s,t)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),!function(e,s){for(var t in s)Object.defineProperty(e,t,{enumerable:!0,get:s[t]})}(s,{default:function(){return c},getImageProps:function(){return i}});let l=t(8140),a=t(5040),n=t(1356),r=l._(t(1124));function i(e){let{props:s}=(0,a.getImgProps)(e,{defaultLoader:r.default,imgConf:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!1}});for(let[e,t]of Object.entries(s))void 0===t&&delete s[e];return{props:s}}let c=n.Image},5239:(e,s,t)=>{"use strict";t.d(s,{default:()=>a.a});var l=t(4652),a=t.n(l)},7840:(e,s,t)=>{"use strict";t.d(s,{A:()=>c});var l=t(5155),a=t(2619),n=t.n(a),r=t(6489),i=t(2115);function c(){let{data:e}=(0,r.useSession)(),[s,t]=(0,i.useState)(!1);return(0,l.jsx)("nav",{className:"bg-white shadow-sm border-b sticky top-0 z-50",children:(0,l.jsxs)("div",{className:"max-w-7xl mx-auto px-4 py-3",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)(n(),{href:"/",className:"text-2xl font-bold text-blue-600 hover:text-blue-700",children:"InstaClone"}),(0,l.jsxs)("div",{className:"hidden md:flex items-center space-x-6",children:[(0,l.jsxs)(n(),{href:"/home",className:"flex items-center space-x-2 text-gray-700 hover:text-blue-600 transition-colors",children:[(0,l.jsx)("span",{className:"text-xl",children:"\uD83C\uDFE0"}),(0,l.jsx)("span",{children:"Trang chủ"})]}),(0,l.jsxs)(n(),{href:"/search",className:"flex items-center space-x-2 text-gray-700 hover:text-blue-600 transition-colors",children:[(0,l.jsx)("span",{className:"text-xl",children:"\uD83D\uDD0D"}),(0,l.jsx)("span",{children:"T\xecm kiếm"})]}),(0,l.jsxs)(n(),{href:"/blog/create",className:"flex items-center space-x-2 text-gray-700 hover:text-blue-600 transition-colors",children:[(0,l.jsx)("span",{className:"text-xl",children:"➕"}),(0,l.jsx)("span",{children:"Tạo b\xe0i"})]}),(0,l.jsxs)(n(),{href:"/profile",className:"flex items-center space-x-2 text-gray-700 hover:text-blue-600 transition-colors",children:[(0,l.jsx)("span",{className:"text-xl",children:"\uD83D\uDC64"}),(0,l.jsx)("span",{children:"Trang c\xe1 nh\xe2n"})]}),e&&(0,l.jsxs)("button",{onClick:()=>(0,r.signOut)({redirect:!0,callbackUrl:"/login"}),className:"flex items-center space-x-2 text-gray-700 hover:text-red-600 transition-colors",children:[(0,l.jsx)("span",{className:"text-xl",children:"\uD83D\uDEAA"}),(0,l.jsx)("span",{children:"Đăng xuất"})]})]}),(0,l.jsx)("button",{onClick:()=>t(!s),className:"md:hidden text-2xl focus:outline-none",children:"☰"})]}),s&&(0,l.jsxs)("div",{className:"md:hidden mt-4 pb-4 space-y-3 border-t pt-4",children:[(0,l.jsx)(n(),{href:"/home",className:"block px-4 py-2 text-gray-700 hover:bg-gray-50 rounded-lg transition-colors",onClick:()=>t(!1),children:"\uD83C\uDFE0 Trang chủ"}),(0,l.jsx)(n(),{href:"/search",className:"block px-4 py-2 text-gray-700 hover:bg-gray-50 rounded-lg transition-colors",onClick:()=>t(!1),children:"\uD83D\uDD0D T\xecm kiếm"}),(0,l.jsx)(n(),{href:"/blog/create",className:"block px-4 py-2 text-gray-700 hover:bg-gray-50 rounded-lg transition-colors",onClick:()=>t(!1),children:"➕ Tạo b\xe0i"}),(0,l.jsx)(n(),{href:"/profile",className:"block px-4 py-2 text-gray-700 hover:bg-gray-50 rounded-lg transition-colors",onClick:()=>t(!1),children:"\uD83D\uDC64 Trang c\xe1 nh\xe2n"}),e&&(0,l.jsx)("button",{onClick:()=>{(0,r.signOut)({redirect:!0,callbackUrl:"/login"}),t(!1)},className:"block w-full text-left px-4 py-2 text-gray-700 hover:bg-red-50 rounded-lg transition-colors",children:"\uD83D\uDEAA Đăng xuất"})]})]})})}}},e=>{e.O(0,[619,489,356,441,493,358],()=>e(e.s=362)),_N_E=e.O()}]);